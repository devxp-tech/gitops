apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: argowf
helmCharts:
  - name: argo-workflows
    releaseName: argo-workflows
    namespace: argowf
    version: 0.40.1
    includeCRDs: true
    repo: https://argoproj.github.io/argo-helm
    valuesInline:
      fullnameOverride: argo-workflows
      crds:
        install: true
      workflow:
        serviceAccount:
          create: true
          name: "argo-workflow"
        rbac:
          create: true
      controller:
        metrics:
          enabled: true
        logging:
          level: debug
        workflowNamespaces:
          - argowf
          - default
      server:
        metrics:
          enabled: true
        logging:
          level: debug
        extraArgs:
          - --auth-mode=sso
        sso:
          enabled: true
          issuer: https://dex.devxp-tech.io
          clientId:
            name: argo-workflows-sso
            key: client-id
          clientSecret:
            name: argo-workflows-sso
            key: client-secret
          redirectUrl: https://argowf.devxp-tech.io/oauth2/callback
          rbac:
            enabled: false
          # scopes:
          #   - openid
          #   - email
          #   - profile
          #   - groups
