apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: observability
helmCharts:
  - name: tempo
    includeCRDs: true
    releaseName: tempo
    version: 1.7.2
    repo: https://grafana.github.io/helm-charts
    valuesInline:
      labels:
        app: tempo
      replicas: 2
      serviceAccount:
        name: tempo
        annotations:
          "eks.amazonaws.com/role-arn": "arn:aws:iam::239468932737:role/tempo-lgseksd1-sa"
        automountServiceAccountToken: true
      serviceMonitor:
        enabled: true
      gateway:
        enabled: true
      tempoQuery:
        enabled: true
        service:
          port: 16685
        searchEnabled: true
        storage:
          trace:
            backend: s3 # we're using minio anyway!
            s3:
              bucket: vex-dev-tempo-traces
              endpoint: s3.us-east-1.amazonaws.com
              region: us-east-1
        receivers:
          jaeger:
            protocols:
              grpc:
                endpoint: 0.0.0.0:14250
              thrift_binary:
                endpoint: 0.0.0.0:6832
              thrift_compact:
                endpoint: 0.0.0.0:6831
              thrift_http:
                endpoint: 0.0.0.0:14268
          otlp:
            protocols:
              grpc:
                endpoint: "0.0.0.0:4317"
              http:
                endpoint: "0.0.0.0:4318"
          zipkin:
